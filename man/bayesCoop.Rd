% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bayesCoop.R
\name{bayesCoop}
\alias{bayesCoop}
\title{bayesCoop}
\usage{
bayesCoop(
  data_train,
  data_test,
  family = "gaussian",
  ss = c(0.05, 1),
  group = TRUE,
  bb = TRUE,
  alpha_dirich = 1,
  bbiters = 1100,
  bbburn = 100,
  maxit = 100,
  filter = TRUE,
  abd_thresh = 0,
  prev_thresh = 0.1,
  Warning = TRUE,
  verbose = TRUE,
  control = list()
)
}
\arguments{
\item{data_train}{a list of feature_table, sample_metadata and feature_metadata from training
data (unstandardized). See \emph{IntegratedLearner} for more details.}

\item{data_test}{a list of feature_table, sample_metadata and feature_metadata from testing
data (unstandardized). See \emph{IntegratedLearner} for more details.}

\item{family}{currently supports only Gaussian family. Default: "gaussian".}

\item{ss}{a length-2 numeric vector giving the spike/sLab scales c(s0, s1) with s0 < s1.
Default: c(0.05, 1).}

\item{group}{logical. If TRUE, predictors are grouped by modality and given a group
spike-and-slab prior. If FALSE, no grouping is used. Default: TRUE.}

\item{bb}{logical. If TRUE, run full Bayesian bootstrap inference; if FALSE, run MAP
estimation over a user-supplied rho grid in \code{control}. Default: TRUE.}

\item{alpha_dirich}{Dirichlet concentration for Bayesian bootstrap weights. Default: 1.}

\item{bbiters}{number of Bayesian bootstrap iterations. Default: 1100.}

\item{bbburn}{number of burn-in iterations discarded from the bootstrap. Default: 100.}

\item{maxit}{maximum EM iterations in the inner optimizer. Default: 100.}

\item{filter}{logical. If TRUE, apply abundance/prevalence filtering to features. Default: TRUE.}

\item{abd_thresh}{minimum abundance threshold for keeping a feature. Default: 0.}

\item{prev_thresh}{minimum prevalence threshold (proportion of samples above abd_thresh).
Default: 0.1.}

\item{Warning}{logical. If TRUE, emit non-convergence warnings. Default: TRUE.}

\item{verbose}{logical. If TRUE, print iteration counts and runtime. Default: TRUE.}

\item{control}{a named list with element \code{rho}, giving one or more candidate rho values
to try when \code{bb = FALSE}.}
}
\value{
If \code{bb = TRUE}, a list with:
\item{y_samples}{posterior predictive draws (approximate)}
\item{y_pred}{posterior predictive median for each held-out sample}
\item{mspe}{mean squared prediction error on test data}
\item{beta_samples}{posterior draws of regression coefficients}
\item{beta_postmed}{posterior median coefficients}
\item{rho_samples}{posterior draws of consensus penalty \code{rho}}
\item{rho_postmed}{posterior median of \code{rho}}
\item{errVar_samples}{posterior draws of residual variance}
\item{time}{runtime in minutes}

If \code{bb = FALSE}, a list with:
\item{y_pred}{predicted response values on test data}
\item{mspe}{mean squared prediction error on test data}
\item{beta_MAP}{MAP estimate of regression coefficients}
\item{rho_MAP}{selected \code{rho} (minimizing MSPE over \code{control$rho})}
\item{time}{runtime in minutes}
}
\description{
This function implements the BayesCOOP methodology for supervised multimodal
integration. It combines jittered group spike-and-slab LASSO regularization with intermediate
fusion to enable integrative learning across multiple data modalities. For uncertainty
quantification, BayesCOOP applies the Bayesian bootstrap to generate approximate posterior
samples by performing maximum a posteriori (MAP) estimation on jittered and resampled
multimodal datasets. Currently, only continuous outcomes are supported.
}
